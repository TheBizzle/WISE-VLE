<!--
* Copyright (c) 2009 Regents of the University of California (Regents). Created
* by TELS, Graduate School of Education, University of California at Berkeley.
*
* This software is distributed under the GNU Lesser General Public License, v2.
*
* Permission is hereby granted, without written agreement and without license
* or royalty fees, to use, copy, modify, and distribute this software and its
* documentation for any purpose, provided that the above copyright notice and
* the following two paragraphs appear in all copies of this software.
*
* REGENTS SPECIFICALLY DISCLAIMS ANY WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
* THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
* PURPOSE. THE SOFTWAREAND ACCOMPANYING DOCUMENTATION, IF ANY, PROVIDED
* HEREUNDER IS PROVIDED "AS IS". REGENTS HAS NO OBLIGATION TO PROVIDE
* MAINTENANCE, SUPPORT, UPDATES, ENHANCEMENTS, OR MODIFICATIONS.
*
* IN NO EVENT SHALL REGENTS BE LIABLE TO ANY PARTY FOR DIRECT, INDIRECT,
* SPECIAL, INCIDENTAL, OR CONSEQUENTIAL DAMAGES, INCLUDING LOST PROFITS,
* ARISING OUT OF THE USE OF THIS SOFTWARE AND ITS DOCUMENTATION, EVEN IF
* REGENTS HAS BEEN ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*
* @author: Hiroki Terashima
-->
<html>
    <head>
        <script type="text/javascript" src="../../util/scriptloader.js">
        </script>
        <script type="text/javascript">
            var fillinObj;
            var or; // global variable so it can be accessed by other functions
            var states = []; // array of FILLINSTATE objects
            var currentTextEntryInteractionIndex = 0;
            
            /*
             * This is called by fillin_authoring.html after it has
             * set the node.
             */
            function loadAuthoring(){
                //retrieve the content
                var xmlString = node.element.getElementsByTagName("jaxbXML")[0].firstChild.nodeValue;
                
                //create an xml object from the xmlString
                if (window.ActiveXObject) {
                    xmlObj = new ActiveXObject("Microsoft.XMLDOM");
                    xmlObj.async = "false";
                    xmlObj.loadXML(xmlString);
                }
                else {
                    var parser = new DOMParser();
                    xmlObj = parser.parseFromString(xmlString, "text/xml");
                }
                
                //create the mc object
                fillinObj = new FILLIN(xmlObj);
                
                //render the mc object so that it's content gets loaded in this html page
                fillinObj.render(currentTextEntryInteractionIndex);
                
                /*
                 * calls afterAuthoringLoaded() in multiplechoice_authoring.html so that
                 * multiplechoice_authoring.html can do what it needs to do with the mc
                 * object.
                 */
                parent.afterAuthoringLoaded();
            }
            
            function save(){
                fillinObj.save();
            }
            
            function edit(){
                fillinObj.edit();
            }
            
            /**
             * xmlString contains QTI-coded xml content
             */
            function loadFromXMLString(xmlDoc){
                //var xmlDoc=loadXMLDocFromString(xmlString);
                fillinObj = new FILLIN(xmlDoc);
                fillinObj.render(currentTextEntryInteractionIndex);
            }
            
            function checkAnswer(){
                fillinObj.checkAnswer();
            }
            
            /**
             * sets VLE, loads state
             */
            function loadFromVLE(node, vle){
                fillinObj.loadFromVLE(node, vle);
            }
            
            function tryAgain(){
                fillinObj.tryAgain();
            }
            
            function next(){
                var isNextDisabled = hasClass("nextButton", "disabledLink");
                
                if (isNextDisabled) {
                    return;
                }
                
                currentTextEntryInteractionIndex++;
                fillinObj.render(currentTextEntryInteractionIndex);
            }
            
            var newWin = null;
            function popUp(strURL, strType, strHeight, strWidth){
                if (newWin != null && !newWin.closed) 
                    newWin.close();
                var strOptions = "";
                if (strType == "console") 
                    strOptions = "resizable,height=" +
                    strHeight +
                    ",width=" +
                    strWidth;
                if (strType == "fixed") 
                    strOptions = "status,height=" +
                    strHeight +
                    ",width=" +
                    strWidth;
                if (strType == "elastic") 
                    strOptions = "toolbar,menubar,scrollbars," +
                    "resizable,location,height=" +
                    strHeight +
                    ",width=" +
                    strWidth;
                newWin = window.open(strURL, 'newWin', strOptions);
                newWin.focus();
            }
            
            function afterScriptsLoad(){
                 
            }
            
            window.onload = function(){
                scriptloader.initialize(document, afterScriptsLoad, 'fillin');
            };
        </script>
        <!--Nifty("div#rightColumn,div#leftColumn","none same-height");-->
    </head>
    <body>
    <div id="centeredDiv">
        <table class="instructionsReminder">
            <tr>
                <td>
                    <div id="helpIcon">
                        <a href="FillBlankInfoBox.html" onclick="popUp(this.href,'console',800,800);return false;" target="_blank">&nbsp&nbsp&nbsp</a>
                    </div>
                </td>
                <td>
                    <a id="helpTextLink" href="FillBlankInfoBox.html" onclick="popUp(this.href,'console',800,800);return false;" target="_blank">instructions</a>
                </td>
            </tr>
        </table>
        <div id="questionTable">
            <div id="questionType">
                Fill in the Blank
            </div>
        </div>
    </div>
    <!-- end of questinCountBox -->
    <div>
        <div id="promptDiv" class="Color1">
            Fill each blank with the correct word(s).
        </div>
    </div>
    <div id="currentFillBlankParagraph">
        <div id="leftColumn">
            <div id="nonInteractiveDiv">
            </div>
            <div id="interactiveDiv">
            </div>
        </div>
        <div id="rightColumn">
            <img src="../../images/fill_blanks.png" alt="Robot Art Fill the Blanks" width="100" height="250" border="0" />
        </div>
    </div>
    <div id="clearBoth">
    </div>
    <!-- Anchor-Based Button Layout using TABLE -->
    <div id="buttonDiv">
        <table id="buttonTable">
            <tr>
                <td>
                    <a href="#" id="checkAnswerButton" onClick="javascript:checkAnswer();">Check Blank</a>
                </td>
                <td>
                    <a href="#" id="tryAgainButton" onClick="javascript:tryAgain();">Try Again</a>
                </td>
                <td>
                    <a href="#" id="nextButton" onClick="javascript:next();">Next</a>
                </td>
            </tr>
        </table>
    </div>
    <div id="feedbackDiv">
    </div>
    <!-- styled in htmlAssessment.css -->
    </div>
    <!-- end centered Div -->
</body>
</html>
